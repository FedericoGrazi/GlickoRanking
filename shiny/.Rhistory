"Luca Leoni", "Giacomo Merlin",
"Sebastiano Guerra", "Francesco Mezzetti",
"Riccardo Magnani", "Simone Stagni",
"Federico Grazi", "Tobia Sermenghi",
"Giacomo Colliva", "Dario Shir Akbari",
"Tommaso Marzocchi", "Elena Rossetto",
"Chiara Pernigo", "Riccardo Mercadini",
"Giovanni Messina", "Lorenzo Masotti",
"Davide Greco", "Lorenzo Favati",
"Luca Tosatti", "Matteo Sacchini",
"Filippo Fabbri", "Lorenzo Ghinelli",
"Samuele Contucci", "Mattia Penasa",
"Marianne Ferragina", "Laura Lucchiari",
"Nicole Biondini", "Ivan Bolognesi",
"Alice Mastroilli", "Arianna Esti",
"Matteo Molli", "Mattia Pareschi",
"Dario Filippi", "Gianluca Sartin",
"Alessandro Zanellato", "Jacopo Dudine",
"Anton Schoenberger", "Andrea De Valiere",
"Samuele Violante", "Leo Pastore",
"Martina Melchionda", "Veronica Specchia",
"Francesco Stupazzini", "Hannes Huber",
"Giacomo Leoni", "Matteo Zandi"
)
open <- as.data.frame.matrix(matrix(stringr::str_to_title(open), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
open$punti1 <- rank$p[match(open$V1,stringr::str_to_title(rank$g))]
open$punti2 <- rank$p[match(open$V2,stringr::str_to_title(rank$g))]
open <- dplyr::mutate(open, dplyr::across(dplyr::contains("punti"), function(x) ifelse(is.na(x),0,x)))
open$p <- open$punti1+ open$punti2
open[order(-open$p),]
source("D:/Personal Statistics/rcb/Ranking/ranking_function.R")
openList <-
c(
"Andrea Borsotti", "Nicola Bazzani",
"Giovanni Zerbo", "Mattia Bazzani",
"Luca Leoni", "Giacomo Merlin",
"Sebastiano Guerra", "Francesco Mezzetti",
"Riccardo Magnani", "Simone Stagni",
"Federico Grazi", "Tobia Sermenghi",
"Giacomo Colliva", "Dario Shir Akbari",
"Tommaso Marzocchi", "Elena Rossetto",
"Chiara Pernigo", "Riccardo Mercadini",
"Giovanni Messina", "Lorenzo Masotti",
"Davide Greco", "Lorenzo Favati",
"Luca Tosatti", "Matteo Sacchini",
"Filippo Fabbri", "Lorenzo Ghinelli",
"Samuele Contucci", "Mattia Penasa",
"Marianne Ferragina", "Laura Lucchiari",
"Nicole Biondini", "Ivan Bolognesi",
"Alice Mastroilli", "Arianna Esti",
"Matteo Molli", "Mattia Pareschi",
"Dario Filippi", "Gianluca Sartin",
"Alessandro Zanellato", "Jacopo Dudine",
"Anton Schoenberger", "Andrea De Valiere",
"Samuele Violante", "Leo Pastore",
"Martina Melchionda", "Veronica Specchia",
"Francesco Stupazzini", "Hannes Huber",
"Giacomo Leoni", "Matteo Zandi"
)
colnames(rank) <- c("giocatore", "nTourns", "Rating")
rank
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
colnames(rank) <- c("giocatore", "nTourns", "Rating")
make_groups(list =  openList, rat = list(ratings = rank))
list(ratings = rank)
make_groups(list =  openList, rat = list(ratings = rank))
make_groups(mat = NULL,list =openList, rat = list(ratings = rank))
library(tidyverse)
make_groups(list =openList, rat = list(ratings = rank))
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5)
open
open <- as.data.frame.matrix(matrix(str_to_title(openList), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
open$punti1 <- rank$p[match(open$V1,str_to_title(rank$g))]
open$punti2 <- rank$p[match(open$V2,str_to_title(rank$g))]
open <- mutate(open, across(contains("punti"), function(x) ifelse(is.na(x),0,x)))
open$p <- open$punti1+ open$punti2
open[order(-open$p),]
colnames(rank) <- c("giocatore", "nTourns", "Rating")
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5)
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
rank$giocatore <- str_to_title(rank$giocatore)
open <- as.data.frame.matrix(matrix(str_to_title(openList), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
rank$giocatore <- str_to_title(rank$giocatore)
open$punti1 <- rank$Rating[match(open$V1,rank$giocatore)]
open <- as.data.frame.matrix(matrix(str_to_title(openList), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
colnames(rank) <- c("giocatore", "nTourns", "Rating")
rank$giocatore <- str_to_title(rank$giocatore)
open$punti1 <- rank$Rating[match(open$V1,rank$giocatore)]
open$punti2 <- rank$Rating[match(open$V2,rank$giocatore)]
open <- mutate(open, across(contains("punti"), function(x) ifelse(is.na(x),0,x)))
open$p <- open$punti1+ open$punti2
open[order(-open$p),]
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5)
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5, View = T)
openList <-
c(
"Andrea Borsotti", "Nicola Bazzani",
"Giovanni Zerbo", "Mattia Bazzani",
"Luca Leoni", "Giacomo Merlin",
"Sebastiano Guerra", "Francesco Mezzetti",
"Riccardo Magnani", "Simone Stagni",
"Federico Grazi", "Tobia Sermenghi",
"Giacomo Colliva", "Dario Shir Akbari",
"Tommaso Marzocchi", "Elena Rossetto",
"Chiara Pernigo", "Riccardo Mercadini",
"Giovanni Messina", "Lorenzo Masotti",
"Davide Greco", "Lorenzo Favati",
"Luca Tosatti", "Matteo Sacchini",
"Filippo Fabbri", "Lorenzo Ghinelli",
"Samuele Contucci", "Mattia Penasa",
"Marianne Ferragina", "Laura Lucchiari",
"Nicole Biondini", "Ivan Bolognesi",
"Alice Mastroilli", "Arianna Esti",
"Matteo Molli", "Mattia Pareschi",
"Dario Filippi", "Gianluca Sartin",
"Alessandro Zanellato", "Jacopo Dudine",
"Anton Schoenberger", "Andrea De Valiere",
"Samuele Violante", "Leo Pastore",
"Martina Melchionda", "Veronica Specchia",
"Francesco Stupazzini", "Hannes Huber",
"Giacomo Leoni", "Matteo Zandi",
"Marco Pasotti", "Francesco Pasotti"
)
open <- as.data.frame.matrix(matrix(str_to_title(openList), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
colnames(rank) <- c("giocatore", "nTourns", "Rating")
rank$giocatore <- str_to_title(rank$giocatore)
open$punti1 <- rank$Rating[match(open$V1,rank$giocatore)]
open$punti2 <- rank$Rating[match(open$V2,rank$giocatore)]
open <- mutate(open, across(contains("punti"), function(x) ifelse(is.na(x),0,x)))
open$p <- open$punti1+ open$punti2
open[order(-open$p),]
openList <-
c(
"Andrea Borsotti", "Nicola Bazzani",
"Giovanni Zerbo", "Mattia Bazzani",
"Luca Leoni", "Giacomo Merlin",
"Sebastiano Guerra", "Francesco Mezzetti",
"Riccardo Magnani", "Simone Stagni",
"Federico Grazi", "Tobia Sermenghi",
"Giacomo Colliva", "Dario Shir Akbari",
"Tommaso Marzocchi", "Elena Rossetto",
"Chiara Pernigo", "Riccardo Mercadini",
"Giovanni Messina", "Lorenzo Masotti",
"Davide Greco", "Lorenzo Favati",
"Luca Tosatti", "Matteo Sacchini",
"Filippo Fabbri", "Lorenzo Ghinelli",
"Samuele Contucci", "Mattia Penasa",
"Marianne Ferragina", "Laura Lucchiari",
"Nicole Biondini", "Ivan Bolognesi",
"Alice Mastroilli", "Arianna Esti",
"Matteo Molli", "Mattia Pareschi",
"Dario Filippi", "Gianluca Sartin",
"Alessandro Zanellato", "Jacopo Dudine",
"Anton Schoenberger", "Andrea De Valiere",
"Samuele Violante", "Leo Pastore",
"Martina Melchionda", "Veronica Specchia",
"Francesco Stupazzini", "Hannes Huber",
"Giacomo Leoni", "Matteo Zandi",
"Marco Pasotto", "Francesco Pasotto"
)
open <- as.data.frame.matrix(matrix(str_to_title(openList), ncol = 2, byrow = T))
rank <- readxl::read_excel("C:/Users/Feder/Downloads/rankingITA.xlsx")
colnames(rank) <- c("giocatore", "nTourns", "Rating")
rank$giocatore <- str_to_title(rank$giocatore)
open$punti1 <- rank$Rating[match(open$V1,rank$giocatore)]
open$punti2 <- rank$Rating[match(open$V2,rank$giocatore)]
open <- mutate(open, across(contains("punti"), function(x) ifelse(is.na(x),0,x)))
open$p <- open$punti1+ open$punti2
open[order(-open$p),]
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5)
make_groups(list =openList, rat = list(ratings = rank), ngroup = 5, View = T)
grouops <- make_groups(list =openList, rat = list(ratings = rank), ngroup = 5)
grouops
grouops <- grouops %>% mutate(across(contains("Group"), \(d) gsub(x = d, patter = "\([:digits:]\)", replacement = "")))
grouops <- grouops %>% mutate(across(contains("Group"), \(d)  gsub("\\s*\\(\\d+\\)", "", d)))
group_by()
grouops
grouops[,1]
for(i in 1:ng){
t <- grouops[,i] %>% na.omit()
}
ng <- 5
for(i in 1:ng){
t <- grouops[,i] %>% na.omit()
}
t
i = 1
t <- grouops[,i] %>% na.omit()
t
source("D:/Personal Statistics/rcb/Ranking/ranking_function.R")
source("D:/Personal Statistics/rcb/Ranking/ranking_function.R")
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player D"),
Rating = rep(1500,4),
Deviation = c(50,50,100,100),
LastPen = rep(0,4),
LastTourn = rep(0,4))
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play1 = c("Player A & Player B", "Player C & Player D", "Player C & Player D"),
Score = 1,
Weight = 1
)
glicko_ets(games, status)
library(PlayerRatings)
library(readxl)
library(xlsx)
library(tidyverse)
library(ggdark)
library(ggthemes)
library(tools)
library(foreach)
games
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play2 = c("Player A & Player B", "Player C & Player D", "Player C & Player D"),
Score = 1,
Weight = 1
)
glicko_ets(games, status)
source("D:/Personal Statistics/rcb/Ranking/ranking_function.R")
glicko_ets(games, status)
load("D:/Personal Statistics/rcb/Ranking/data/Extra/Init.rda")
glicko_ets(games, status)
initval <- Init23
initval$initrats[initval$categories == "Women's Pro"] <- 1300
initval$initdev[initval$categories == "Women's Pro"] <- 200
initval <- rbind(initval, c(categories = "German Contender", initrats = 1300, initdev = 250))
# initval[initval$categories %in%  c("Open Pro", "Open Contender"),2:3] <- matrix(c(1600,1300,300,300),2,2) # Normal Double Update
initval[initval$categories %in%  c("Open Pro", "Open Contender", "Pro German"),2:3] <- matrix(c(1600,1450, 1350,300,300,175),3,2) # Full Update
glicko_ets(games, status)
results <- glicko_ets(games, status)
p <- glicko_percentages(results, status)
status
results
status
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player D"),
Rating = rep(1500,4),
Deviation = c(50,50,100,100),
Games = 0,
Win = 0,
Loss = =0,
nTourn =0,
LastTourn = 0,
LastPen = 0,
PeakElo = 0,
PeakRank = 8,
PeakTime = 0,
Percentile = 0
)
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play2 = c("Player A & Player B", "Player C & Player D", "Player C & Player D"),
Score = 1,
Weight = 1
)
results <- glicko_ets(games, status)
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player D"),
Rating = rep(1500,4),
Deviation = c(50,50,100,100),
Games = 0,
Win = 0,
Loss = =0,
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player D"),
Rating = rep(1500,4),
Deviation = c(50,50,100,100),
Games = 0,
Win = 0,
Loss =0,
nTourn =0,
LastTourn = 0,
LastPen = 0,
PeakElo = 0,
PeakRank = 8,
PeakTime = 0,
Percentile = 0
)
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play2 = c("Player A & Player B", "Player C & Player D", "Player C & Player D"),
Score = 1,
Weight = 1
)
results <- glicko_ets(games, status)
results
status
status <- list(ratings = status)
results <- glicko_ets(games, status$ratings)
status <- results %>% mutate(Rating = 1500,Deviation)
status$ratings
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player E", "Player F", "Player G", "Player H"),
Rating = rep(1500,8),
Deviation = c(50,50,100,100,50,50,100,100),
Games = 0,
Win = 0,
Loss =0,
nTourn =0,
LastTourn = 0,
LastPen = 0,
PeakElo = 0,
PeakRank = 8,
PeakTime = 0,
Percentile = 0
)
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play2 = c("Player E & Player F", "Player C & Player D", "Player G & Player H"),
Score = 1,
Weight = 1
)
results <- glicko_ets(games, status)
status
status <- data.frame(giocatore = c("Player A", "Player B", "Player C", "Player E", "Player F", "Player G", "Player H"),
Rating = rep(1500,8),
Deviation = c(50,50,100,100,50,50,100,100),
Games = 0,
Win = 0,
Loss =0,
nTourn =0,
LastTourn = 0,
LastPen = 0,
PeakElo = 0,
PeakRank = 8,
PeakTime = 0,
Percentile = 0
)
status <- data.frame(giocatore = c("Player A", "Player B", "Player C","Player D", "Player E", "Player F", "Player G", "Player H"),
Rating = rep(1500,8),
Deviation = c(50,50,100,100,50,50,100,100),
Games = 0,
Win = 0,
Loss =0,
nTourn =0,
LastTourn = 0,
LastPen = 0,
PeakElo = 0,
PeakRank = 8,
PeakTime = 0,
Percentile = 0
)
games <- data.frame(
cat = "Open",
Time = 0,
Play1 = c("Player A & Player B", "Player A & Player B", "Player C & Player D"),
Play2 = c("Player E & Player F", "Player C & Player D", "Player G & Player H"),
Score = 1,
Weight = 1
)
results <- glicko_ets(games, status)
results
results <- glicko_ets(games, status, cval = 14, rdmax = 200)
status <- results %>% mutate(Rating = 1500,Deviation)
results
results$impr
p <- glicko_percentages(results, status)
p <- glicko_percentages(results, status, initval = Init23, "c")
p <- glicko_percentages(results, status, initval = Init23, "c", perch = NULL)
p <- glicko_percentages(results, status, initval = Init23, "c", perch = NULL)
p
a <- glicko_keep(results, status, "c", NULL, Init23)
a
results <- glicko_ets(games, status, cval = 0, rdmax = 200)
status
results <- glicko_ets(games, status, cval = 0, rdmax = 200)
results
p <- glicko_percentages(results, status, initval = Init23, "c", perch = NULL)
p
a <- glicko_keep(results, status, "c", NULL, Init23)
a
shiny::runApp('D:/Personal Statistics/rcb/Predictions/Nationals')
setwd("D:/Personal Statistics/rcb/Predictions/Nationals")
data <- read_excel(path = "Prediction Nationals 2025(1-23).xlsx") %>%
select(-ID:-`Ora ultima modifica`, -contains("Mostra"))
res.open <- data %>% select(`Chi sei?`,contains("Open")) %>% rename_with(~ paste0("P", 1:16), .cols = 2:17)
t1 <-t2 <-  NULL
for(i in 1:nrow(res.open)){
t1 <- c(t1,c(res.open[i,-1]))
t2 <- c(t2,c(res.misto[i,-1]))
}
t.open <- na.omit(unique(unlist(t1)))
t.misto <- na.omit(unique(unlist(t2)))
open <- data.frame(
pos = 1:16,
team = t.open[c(1,2,4,6,3,17,9,7,8,10,19,12,22,5,14,13)]
)
t.open
res.open
library(dplyr)
library(readxl)
library(tidyr)
setwd("D:/Personal Statistics/rcb/Predictions/Nationals")
data <- read_excel(path = "Prediction Nationals 2025(1-23).xlsx") %>%
select(-ID:-`Ora ultima modifica`, -contains("Mostra"))
data <- read_excel(path = "www/Prediction Nationals 2025(1-23).xlsx") %>%
select(-ID:-`Ora ultima modifica`, -contains("Mostra"))
res.open <- data %>% select(`Chi sei?`,contains("Open")) %>% rename_with(~ paste0("P", 1:16), .cols = 2:17)
res.misto <- data %>% select(`Chi sei?`,contains("Misto"))%>% rename_with(~ paste0("P", 1:8), .cols = 2:9)
t1 <-t2 <-  NULL
for(i in 1:nrow(res.open)){
t1 <- c(t1,c(res.open[i,-1]))
t2 <- c(t2,c(res.misto[i,-1]))
}
t.open <- na.omit(unique(unlist(t1)))
t.misto <- na.omit(unique(unlist(t2)))
saveRDS(t.open, "www/t.open.RDS")
saveRDS(t.misto, "www/t.misto.RDS")
runApp()
t.open
open <- data.frame(
pos = 1:16,
team = t.open[c(1,2,4,6,3,17,9,7,8,10,19,12,22,5,14,13)]
)
misto <- data.frame(
pos = 1:8,
team = t.misto[c(1,2,3,4,6,7,8,9)]
)
saveRDS(misto, "www/t.misto.RDS")
saveRDS(open, "www/t.open.RDS")
runApp()
runApp()
runApp()
d <- read_excel(path = "www/Prediction Nationals 2025(1-23).xlsx") %>%
select(-ID:-`Ora ultima modifica`, -contains("Mostra"))
d <- d %>% select(`Chi sei?`,contains("Open")) %>% rename_with(~ paste0("P", 1:16), .cols = 2:17)
maxP
maxP <- 4
d %>%  transmute(Nomi = `Chi sei?`,
across(contains("P"), ~match(.,team_names()$team))) %>%
mutate(across(
contains("P"),
~ {
c.num <- as.numeric(gsub("P", "", cur_column()))
pmax(maxP - abs(. - c.num), 0)
}
))
d %>%  transmute(Nomi = `Chi sei?`,
across(contains("P"), ~match(.,open$team))) %>%
mutate(across(
contains("P"),
~ {
c.num <- as.numeric(gsub("P", "", cur_column()))
pmax(maxP - abs(. - c.num), 0)
}
))
cur.data <- d %>%  transmute(Nomi = `Chi sei?`,
across(contains("P"), ~match(.,open$team))) %>%
mutate(across(
contains("P"),
~ {
c.num <- as.numeric(gsub("P", "", cur_column()))
pmax(maxP - abs(. - c.num), 0)
}
))
cur.data  %>%
group_by(Nomi) %>%
select(Nomi, P1:P4)
cur.data  %>%
group_by(Nomi) %>%
select(Nomi, P1:P4) %>%
summarize(Punti = sum(across(contains("P")), na.rm = TRUE),
Correct = sum(across(contains("P"))==4, na.rm = TRUE),
OffBy1 = sum(across(contains("P"))==3, na.rm = TRUE)) %>%
arrange(-Punti)
cur.data %>%
group_by(Nomi) %>%
summarize(Punti = sum(across(contains("P")), na.rm = TRUE),
Correct = sum(across(contains("P"))==maxP, na.rm = TRUE),
OffBy1 = sum(across(contains("P"))==maxP-1, na.rm = TRUE)) %>%
arrange(-Punti)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
rm(list = ls())
runApp()
data() %>% filter(`Chi sei?` == input$result_table_rows_selected) %>% select(-`Chi sei?`) %>% t %>% as.tibble %>% rename_with("Prediction", cols = 1)
runApp()
runApp()
runApp()
runApp()
runApp()
source("D:/Personal Statistics/rcb/Predictions/display_predictions.R", echo = TRUE)
source("D:/Personal Statistics/rcb/Predictions/display_predictions.R", echo = TRUE)
source("D:/Personal Statistics/rcb/Predictions/display_predictions.R", echo = TRUE)
rm(list = ls())
runApp()
source("D:/Personal Statistics/rcb/Predictions/display_predictions.R", echo = TRUE)
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
runApp('D:/Personal Statistics/rcb/Ranking/shiny')
